<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Chat Interactivo</title>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Fira Code', monospace;
  background:#FFC5CF; /* fondo general rosado */
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  margin:0;
  color: #333333; /* texto general */
}

/* Portada */
#cover {
  text-align:center;
  padding:60px 40px;
  border-radius:25px;
  background:#ffffff;
  display:flex;
  flex-direction:column;
  align-items:center;
  border:1px solid #ddd;
}

#cover-text {
  font-weight: bold;
  font-size:28px;
  margin-bottom:15px;
  color: #333333;
}

#cover-subtext {
  font-size: 13px;
  color: #333333;
  margin-bottom: 20px;
  font-style: italic;
}

#cover-gif {
  width: 200px;
  height: auto;
  margin-bottom: 20px;
  border-radius: 15px;
}

#open-btn {
  padding:12px 25px;
  font-size:18px;
  border:none;
  border-radius:12px;
  background:#a3c4ff; /* color celeste */
  color:#333333;
  cursor:pointer;
  font-family: 'Fira Code', monospace;
  transition: all 0.3s ease;
}

#open-btn:hover {
  background:#88b0e0; /* celeste más oscuro */
  transform: scale(1.05);
}

/* Créditos */
#credits {
  margin-top: 40px;
  font-size: 12px;
  color: #333333;
  text-align: center;
}

/* Chat estilo teléfono */
#chat-container {
  width: 360px;           
  height: 640px;          
  display:flex;
  flex-direction:column;
  background:#ffffff; /* chat blanco */
  border-radius:25px;
  padding:15px;
  overflow-y:auto;
  display:none;
  border:1px solid #ddd;
  box-sizing:border-box;
}

#chat-header {
  font-weight: bold;
  font-size:16px;
  color:#333333;
  border-bottom:1px solid #ddd;
  padding-bottom:10px;
  margin-bottom:10px;
}

/* Mensajes */
#messages {
  display:flex;
  flex-direction:column;
  flex:1;                 
  padding-bottom:10px;
  overflow-y:auto;
}

.message {
  margin:8px 0;
  padding:10px 15px;
  border-radius:15px;
  max-width:80%;
  opacity:0;
  transform: translateY(20px);
  transition: opacity 0.5s ease, transform 0.5s ease;
  color: #333333;
}

.message.show {
  opacity:1;
  transform: translateY(0);
}

.bot {
  align-self:flex-start;
  background:#AFDCF1; /* azul claro */
  color:#333333;
}

.user {
  align-self:flex-end;
  background:#FFEFBD; /* amarillo */
  color:#333333;
}

/* Línea divisoria */
.divider {
  width: 100%;
  height: 1px;
  background-color: #ddd;
  margin: 10px 0;
}

/* Typing animado */
#typing {
  font-style: italic;
  color:#555;
  margin:5px 0;
  display:none;
}

/* Botones de opciones */
#options {
  display:flex;
  flex-direction:column;
  margin-top:5px;
}

.option {
  margin:5px 0;
  padding:10px 15px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  background:#FFEFBD; /* amarillo de la burbuja */
  color:#333333;
  font-family: 'Fira Code', monospace;
  display:none;
  transition: all 0.3s ease;
}

.option:hover {
  background:#f8e08a; /* amarillo más intenso al pasar cursor */
  transform: scale(1.03);
}

/* Estilo para links dentro de mensajes */
.message a {
  color: #ff7f9a; /* rosa suave que contraste con amarillo */
  text-decoration: underline;
  font-weight: bold;
}
</style>
</head>
<body>

<!-- Portada -->
<div id="cover">
  <div id="cover-text">Recibiste un mensaje</div>
  <div id="cover-subtext">Podría cambiarlo todo, ¿te atreves a abrirlo?</div>
  <img id="cover-gif" src="https://i.imgur.com/0GAl9BX.gif" alt="gif portada">
  <button id="open-btn">Abrir</button>
  <div id="credits">
    all rights reserved to @izonfalzo<br>
    Gift made with ♥ by @sadicarte.
  </div>
</div>

<!-- Chat -->
<div id="chat-container">
  <div id="chat-header">anónimo</div>
  <div id="messages"></div>
  <div id="typing">writing</div>
  <div class="divider"></div>
  <div id="options"></div>
</div>

<!-- Audios -->
<audio id="send-sound" src="send.mp3" preload="auto"></audio>
<audio id="receive-sound" src="received.mp3" preload="auto"></audio>

<script>
const cover = document.getElementById('cover');
const openBtn = document.getElementById('open-btn');
const chatContainer = document.getElementById('chat-container');
const messagesDiv = document.getElementById('messages');
const typingDiv = document.getElementById('typing');
const optionsDiv = document.getElementById('options');

const sendSound = document.getElementById('send-sound');
const receiveSound = document.getElementById('receive-sound');

openBtn.onclick = () => {
  cover.style.display = 'none';
  chatContainer.style.display = 'flex';
  showTypingMessage("Hola, tengo algo especial para ti.", [
    {text: "¿Qué es?", next: "pregunta1"}
  ]);
};

function addMessage(text, sender) {
  const msg = document.createElement('div');
  msg.classList.add('message', sender);
  msg.innerHTML = text;
  messagesDiv.appendChild(msg);
  setTimeout(() => msg.classList.add('show'), 50);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;

  if(sender === 'user') {
    sendSound.currentTime = 0;
    sendSound.play();
  } else if(sender === 'bot') {
    receiveSound.currentTime = 0;
    receiveSound.play();
  }
}

function showTypingMessage(message, options = []) {
  optionsDiv.innerHTML = "";
  let dots = 0;
  typingDiv.style.display = 'block';
  const interval = setInterval(() => {
    typingDiv.innerText = 'writing' + '.'.repeat(dots);
    dots = (dots + 1) % 4;
  }, 400);

  setTimeout(() => {
    clearInterval(interval);
    typingDiv.style.display = 'none';
    addMessage(message, 'bot');
    options.forEach(opt => {
      const btn = document.createElement('button');
      btn.classList.add('option');
      btn.innerText = opt.text;
      btn.onclick = () => choose(opt.next, opt.text);
      optionsDiv.appendChild(btn);
      btn.style.display = 'block';
    });
  }, 1800);
}

function choose(nextStep, userText) {
  addMessage(userText, 'user');

  setTimeout(() => {
    if(nextStep === "pregunta1"){
      showTypingMessage("Es un pequeño juego, quiero saber algo de ti...", [
        {text: "Está bien", next: "pregunta2"}
      ]);
    }
    else if(nextStep === "pregunta2"){
      showTypingMessage("Elige un camino: ¿prefieres las estrellas o el mar?", [
        {text: "Estrellas", next: "estrella"},
        {text: "Mar", next: "mar"}
      ]);
    }
    else if(nextStep === "estrella"){
      showTypingMessage("Las estrellas iluminan tu destino. ✦", [
        {text: "¿Y ahora?", next: "finalEstrella"}
      ]);
    }
    else if(nextStep === "mar"){
      showTypingMessage("El mar guarda secretos profundos. ☾", [
        {text: "¿Y ahora?", next: "finalMar"}
      ]);
    }
    else if(nextStep === "finalEstrella"){
      showTypingMessage(
        `Tu viaje termina aquí, pero hay algo esperándote: <a href="https://ejemplo.com/panecitos" target="_blank">constelación</a>`, 
        [{text: "Volver al inicio", next: "reset"}]
      );
    }
    else if(nextStep === "finalMar"){
      showTypingMessage(
        `El mar te lleva a un destino distinto: <a href="https://ejemplo.com/panquesitos" target="_blank">arena</a>`, 
        [{text: "Volver al inicio", next: "reset"}]
      );
    }
    else if(nextStep === "reset"){
      resetToCover();
    }
  }, 600);
}

function resetToCover() {
  messagesDiv.innerHTML = '';
  optionsDiv.innerHTML = '';
  chatContainer.style.display = 'none';
  cover.style.display = 'flex';
}
</script>

</body>
</html>
